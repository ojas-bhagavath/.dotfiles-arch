var VscodeSplitLayout_1,__decorate=this&&this.__decorate||function(t,e,i,s){var o,a=arguments.length,l=a<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,s);else for(var n=t.length-1;n>=0;n--)(o=t[n])&&(l=(a<3?o(l):a>3?o(e,i,l):o(e,i))||l);return a>3&&l&&Object.defineProperty(e,i,l),l};import{html}from"lit";import{customElement,property,queryAssignedElements,state}from"lit/decorators.js";import{classMap}from"lit/directives/class-map.js";import{styleMap}from"lit/directives/style-map.js";import{VscElement}from"../includes/VscElement.js";import styles from"./vscode-split-layout.styles.js";let VscodeSplitLayout=VscodeSplitLayout_1=class extends VscElement{constructor(){super(...arguments),this.split="vertical",this.resetOnDblClick=!1,this.handleSize=4,this.initialHandlePosition="50%",this._startPaneRight=0,this._startPaneBottom=0,this._endPaneTop=0,this._endPaneLeft=0,this._handleLeft=0,this._handleTop=0,this._isDragActive=!1,this._hover=!1,this._hide=!1,this._boundRect=new DOMRect,this._handleOffset=0,this._handleMouseUp=()=>{this._isDragActive=!1,window.removeEventListener("mouseup",this._handleMouseUp),window.removeEventListener("mousemove",this._handleMouseMove)},this._handleMouseMove=t=>{const{clientX:e,clientY:i}=t,{left:s,top:o,height:a,width:l}=this._boundRect;if("vertical"===this.split){const t=e-s,i=Math.max(0,Math.min(t-this._handleOffset,l)),o=i/l*100,a=Math.max(0,l-i)/l*100;this._handleLeft=o,this._startPaneRight=a,this._endPaneLeft=this._handleLeft}if("horizontal"===this.split){const t=i-o,e=Math.max(0,Math.min(t-this._handleOffset,a)),s=e/a*100,l=Math.max(0,a-e)/a*100;this._handleTop=s,this._startPaneBottom=l,this._endPaneTop=this._handleTop}}}connectedCallback(){super.connectedCallback(),this._initPosition()}initializeResizeHandler(){this._initPosition()}_initPosition(){this._boundRect=this.getBoundingClientRect();const{height:t,width:e}=this._boundRect,i="vertical"===this.split?e:t,s=/(^[0-9.]+)(%{0,1})$/.exec(this.initialHandlePosition);let o=0,a=0;s&&(a=parseFloat(s[1])),o=s&&"%"===s[2]?Math.min(i,i/100*a):s&&"%"!==s[2]?Math.min(a,i):i/2,"vertical"===this.split&&(this._startPaneRight=(i-o)/e*100,this._endPaneLeft=o/e*100,this._handleLeft=o/e*100),"horizontal"===this.split&&(this._startPaneBottom=(i-o)/t*100,this._endPaneTop=o/t*100,this._handleTop=o/t*100)}_handleMouseOver(){this._hover=!0,this._hide=!1}_handleMouseOut(t){1!==t.buttons&&(this._hover=!1,this._hide=!0)}_handleMouseDown(t){t.stopPropagation(),t.preventDefault(),this._boundRect=this.getBoundingClientRect();const{left:e,top:i,width:s,height:o}=this._boundRect,a=(t.clientX-e)/s*100,l=(t.clientY-i)/o*100;"vertical"===this.split&&(this._handleOffset=a-this._handleLeft),"horizontal"===this.split&&(this._handleOffset=l-this._handleTop),this._boundRect=this.getBoundingClientRect(),this._isDragActive=!0,window.addEventListener("mouseup",this._handleMouseUp),window.addEventListener("mousemove",this._handleMouseMove)}_handleDblClick(){this.resetOnDblClick&&this._initPosition()}_handleSlotChange(){[...this._nestedLayoutsAtStart,...this._nestedLayoutsAtEnd].forEach((t=>{t instanceof VscodeSplitLayout_1&&t.initializeResizeHandler()}))}render(){const t=styleMap({bottom:`${this._startPaneBottom}%`,right:`${this._startPaneRight}%`}),e=styleMap({left:`${this._endPaneLeft}%`,top:`${this._endPaneTop}%`}),i={left:`${this._handleLeft}%`,top:`${this._handleTop}%`};"vertical"===this.split&&(i.marginLeft=0-this.handleSize/2+"px",i.width=`${this.handleSize}px`),"horizontal"===this.split&&(i.height=`${this.handleSize}px`,i.marginTop=0-this.handleSize/2+"px");const s=styleMap(i),o=classMap({"handle-overlay":!0,active:this._isDragActive,"split-vertical":"vertical"===this.split,"split-horizontal":"horizontal"===this.split}),a=classMap({handle:!0,hover:this._hover,hide:this._hide,"split-vertical":"vertical"===this.split,"split-horizontal":"horizontal"===this.split});return html`
      <div class="start" style="${t}">
        <slot name="start" @slotchange=${this._handleSlotChange}></slot>
      </div>
      <div class="end" style="${e}">
        <slot name="end" @slotchange=${this._handleSlotChange}></slot>
      </div>
      <div class="${o}"></div>
      <div
        class="${a}"
        style="${s}"
        @mouseover="${this._handleMouseOver}"
        @mouseout="${this._handleMouseOut}"
        @mousedown="${this._handleMouseDown}"
        @dblclick="${this._handleDblClick}"
      ></div>
    `}};VscodeSplitLayout.styles=styles,__decorate([property({reflect:!0})],VscodeSplitLayout.prototype,"split",void 0),__decorate([property({type:Boolean,reflect:!0,attribute:"reset-on-dbl-click"})],VscodeSplitLayout.prototype,"resetOnDblClick",void 0),__decorate([property({type:Number,reflect:!0,attribute:"handle-size"})],VscodeSplitLayout.prototype,"handleSize",void 0),__decorate([property({reflect:!0,attribute:"initial-handle-position"})],VscodeSplitLayout.prototype,"initialHandlePosition",void 0),__decorate([state()],VscodeSplitLayout.prototype,"_startPaneRight",void 0),__decorate([state()],VscodeSplitLayout.prototype,"_startPaneBottom",void 0),__decorate([state()],VscodeSplitLayout.prototype,"_endPaneTop",void 0),__decorate([state()],VscodeSplitLayout.prototype,"_endPaneLeft",void 0),__decorate([state()],VscodeSplitLayout.prototype,"_handleLeft",void 0),__decorate([state()],VscodeSplitLayout.prototype,"_handleTop",void 0),__decorate([state()],VscodeSplitLayout.prototype,"_isDragActive",void 0),__decorate([state()],VscodeSplitLayout.prototype,"_hover",void 0),__decorate([state()],VscodeSplitLayout.prototype,"_hide",void 0),__decorate([queryAssignedElements({slot:"start",selector:"vscode-split-layout"})],VscodeSplitLayout.prototype,"_nestedLayoutsAtStart",void 0),__decorate([queryAssignedElements({slot:"end",selector:"vscode-split-layout"})],VscodeSplitLayout.prototype,"_nestedLayoutsAtEnd",void 0),VscodeSplitLayout=VscodeSplitLayout_1=__decorate([customElement("vscode-split-layout")],VscodeSplitLayout);export{VscodeSplitLayout};